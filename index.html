<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TyreXpress — Marketplace Gomme Usate</title>
  <meta name="theme-color" content="#0f172a">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/x-icon" href="icons/favicon.ico">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <style>
    :root{--bg:#0f172a;--card:#111827;--ink:#e5e7eb;--muted:#9ca3af;--accent:#22c55e;--line:#1f2937}
    *{box-sizing:border-box} html,body{margin:0;padding:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;background:var(--bg);color:var(--ink)}
    header{padding:16px;border-bottom:1px solid var(--line);background:#0b1220;position:sticky;top:0;z-index:2}
    h1{margin:0;font-size:22px;color:var(--accent)}
    main{max-width:980px;margin:0 auto;padding:16px}
    section{margin:16px 0}
    .card{background:#0f172a;border:1px solid var(--line);border-radius:12px;padding:14px}
    form{display:grid;gap:10px}
    input,button{padding:10px;border-radius:10px;border:1px solid var(--line);background:#0b1220;color:var(--ink)}
    button{background:var(--accent);border:none;color:#052d13;cursor:pointer}
    .list{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px}
    .item{border:1px solid var(--line);border-radius:12px;padding:12px;background:#0b1220}
    .muted{color:var(--muted)}
    footer{padding:24px;text-align:center;color:var(--muted);border-top:1px solid var(--line)}
  </style>
</head>
<body>
  <header>
    <h1>TyreXpress</h1>
    <div class="muted">Marketplace gomme usate — B2B & B2C</div>
  </header>

  <main>
    <section class="card">
      <h2>Inserisci Gomma</h2>
      <form id="tyreForm" autocomplete="off">
        <input id="marca" type="text" placeholder="Marca (es. Pirelli)" required>
        <input id="misura" type="text" placeholder="Misura (es. 205/55 R16)" required>
        <input id="dot" type="text" placeholder="DOT (anno-settimana, es. 2322)">
        <input id="battistrada" type="number" step="0.1" placeholder="Battistrada residuo (mm)">
        <input id="prezzo" type="number" step="1" placeholder="Prezzo €">
        <input id="citta" type="text" placeholder="Città / Zona">
        <button type="submit">Aggiungi</button>
      </form>
    </section>

    <section>
      <h2>Gomme disponibili</h2>
      <div id="list" class="list"></div>
    </section>
  </main>

  <footer>
    <small>© TyreXpress — PWA demo. Installa dal browser per usarla come app.</small>
  </footer>

  <script>
    // PWA register
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js');
      });
    }

    const $ = id => document.getElementById(id);
    const form = $('tyreForm');
    const list = $('list');

    function loadTyres(){
      return JSON.parse(localStorage.getItem('tyres')||'[]');
    }
    function saveTyres(arr){
      localStorage.setItem('tyres', JSON.stringify(arr));
    }
    function render(){
      const tyres = loadTyres();
      list.innerHTML = '';
      tyres.forEach((t,idx)=>{
        const card = document.createElement('div');
        card.className = 'item';
        card.innerHTML = \`
          <div><strong>\${t.marca}</strong> — \${t.misura}</div>
          <div class="muted">DOT \${t.dot||'—'} · \${t.battistrada? (t.battistrada+' mm'):'—'} · \${t.citta||'—'}</div>
          <div><strong>€ \${t.prezzo||'—'}</strong></div>
          <div style="display:flex;gap:8px;margin-top:8px">
            <button data-del="\${idx}" style="background:#ef4444;color:#fff;border:none;padding:8px 10px;border-radius:8px;cursor:pointer">Elimina</button>
          </div>
        \`;
        list.appendChild(card);
      });
      // attach handlers
      document.querySelectorAll('button[data-del]').forEach(btn=>{
        btn.onclick = () => {
          const tyres = loadTyres();
          tyres.splice(parseInt(btn.dataset.del),1);
          saveTyres(tyres);
          render();
        };
      });
    }

    form.addEventListener('submit', (e)=>{
      e.preventDefault();
      const tyre = {
        marca: $('marca').value.trim(),
        misura: $('misura').value.trim(),
        dot: $('dot').value.trim(),
        battistrada: $('battistrada').value,
        prezzo: $('prezzo').value,
        citta: $('citta').value.trim()
      };
      const tyres = loadTyres();
      tyres.unshift(tyre);
      saveTyres(tyres);
      form.reset();
      render();
    });

    render();
  </script>
</body>
</html>
